<!DOCTYPE html>
<html dir="rtl">
<head>
<title>Moon Downloader</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Arial}
body{
    background:#0f0f0f;
    color:#fff;
    line-height:1.6
}
.container{
    max-width:800px;
    margin:auto;
    padding:20px
}
.header{
    text-align:center;
    padding:30px 0;
    background:linear-gradient(45deg,#1a1a1a,#2a2a2a);
    border-radius:15px;
    margin-bottom:30px
}
.logo{
    font-size:35px;
    color:#00ff88;
    margin-bottom:10px;
    font-weight:bold
}
.url-input{
    width:100%;
    padding:15px;
    background:#222;
    border:2px solid #333;
    color:#fff;
    border-radius:10px;
    font-size:16px;
    margin:10px 0;
    transition:all 0.3s
}
.url-input:focus{
    border-color:#00ff88;
    outline:none
}
.download-btn{
    width:100%;
    padding:15px;
    background:#00ff88;
    color:#000;
    border:none;
    border-radius:10px;
    font-size:16px;
    font-weight:bold;
    cursor:pointer;
    transition:all 0.3s
}
.download-btn:hover{
    background:#00cc6a;
    transform:translateY(-2px)
}
.result{
    background:#222;
    padding:20px;
    border-radius:10px;
    margin:20px 0;
    display:none
}
.format-select{
    width:100%;
    padding:12px;
    background:#333;
    color:#fff;
    border:none;
    border-radius:8px;
    margin:10px 0;
    cursor:pointer
}
.platform-btns{
    display:flex;
    gap:10px;
    margin:15px 0
}
.platform-btn{
    flex:1;
    padding:12px;
    border:none;
    border-radius:8px;
    cursor:pointer;
    font-weight:bold;
    transition:0.3s
}
.youtube{background:#ff0000;color:#fff}
.instagram{background:#e1306c;color:#fff}
.loading{
    text-align:center;
    color:#00ff88;
    margin:20px 0;
    display:none
}
</style>
</head>
<body>
<div class="container">
    <div class="header">
        <div class="logo">Moon Downloader</div>
        <p>تحميل من يوتيوب وانستغرام بدون علامة مائية</p>
    </div>
    
    <div class="platform-btns">

<button class="platform-btn youtube" onclick="setPlatform('youtube')">يوتيوب</button>
        <button class="platform-btn instagram" onclick="setPlatform('instagram')">انستغرام</button>
    </div>

    <input type="text" id="url" class="url-input" placeholder="ضع رابط الفيديو هنا...">
    
    <select id="format" class="format-select">
        <option value="auto">أفضل جودة</option>
        <option value="720">720p</option>
        <option value="480">480p</option>
        <option value="360">360p</option>
    </select>

    <button onclick="download()" class="download-btn">تحميل</button>
    
    <div id="loading" class="loading">جاري التحميل...</div>
    <div id="result" class="result"></div>
</div>

<script>
let currentPlatform = 'youtube';

function setPlatform(platform) {
    currentPlatform = platform;
    document.getElementById('url').placeholder = `ضع رابط ${platform === 'youtube' ? 'يوتيوب' : 'انستغرام'} هنا...`;
}

async function download() {
    const url = document.getElementById('url').value;
    const format = document.getElementById('format').value;
    const loading = document.getElementById('loading');
    const result = document.getElementById('result');

    if (!url) {
        alert('الرجاء إدخال رابط صحيح');
        return;
    }

    loading.style.display = 'block';
    result.style.display = 'none';

    try {
        // استخدام خدمة RapidAPI للتحميل
        const options = {
            method: 'POST',
            headers: {
                'content-type': 'application/json',
                'X-RapidAPI-Key': '2844421e5dmsh6b45d3c42ec7e26p1389dfjsn0cca91431465',
                'X-RapidAPI-Host': currentPlatform === 'youtube' ? 'youtube-video-download-info.p.rapidapi.com' : 'instagram-downloader-download-instagram-videos-stories.p.rapidapi.com'
            },
            body: JSON.stringify({ url })
        };

        const response = await fetch(
            currentPlatform === 'youtube'

? 'https://youtube-video-download-info.p.rapidapi.com/dl'
                : 'https://instagram-downloader-download-instagram-videos-stories.p.rapidapi.com/index',
            options
        );

        const data = await response.json();

        if (data.error) {
            throw new Error(data.error);
        }

        // معالجة النتائج حسب المنصة
        if (currentPlatform === 'youtube') {
            const videoUrl = data.formats.find(f => f.qualityLabel === format)?.url || data.formats[0].url;
            result.innerHTML = `
                <video width="100%" controls>
                    <source src="${videoUrl}" type="video/mp4">
                </video>
                <a href="${videoUrl}" class="download-btn" style="display:block;text-decoration:none;text-align:center;margin-top:10px" 
                   download="video.mp4">تحميل الفيديو</a>
            `;
        } else {
            result.innerHTML = `
                <video width="100%" controls>
                    <source src="${data.media}" type="video/mp4">
                </video>
                <a href="${data.media}" class="download-btn" style="display:block;text-decoration:none;text-align:center;margin-top:10px" 
                   download="instagram-video.mp4">تحميل الفيديو</a>
            `;
        }

        result.style.display = 'block';
    } catch (error) {
        result.innerHTML = `<div style="color:red">حدث خطأ: ${error.message}</div>`;
        result.style.display = 'block';
    } finally {
        loading.style.display = 'none';
    }
}

// تحسين تجربة المستخدم عند الضغط على Enter
document.getElementById('url').addEventListener('keypress', (e) => {
    if (e.key === 'Enter') download();
});
</script>
</body>
</html>
