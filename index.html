
<!DOCTYPE html>
<html dir="rtl">
<head>
<meta charset="UTF-8">
<title>Moon MP4 Pro V7</title>
‎<!-- نفس الـ CSS السابق -->
</head>
<body>
<div class="container">
<div class="header">
<div class="logo">Moon MP4 Pro V7</div>
<div class="subtitle">تحميل فيديوهات مباشر</div>
</div>

<div class="input-group">
<input type="text" id="url" class="url-input" placeholder="ضع رابط الفيديو هنا...">
</div>

<button onclick="download()" class="download-btn">تحميل مباشر</button>
<div id="status" class="status"></div>
<div id="download-options" class="download-options"></div>
</div>

<script>
async function download() {
    const url = document.getElementById('url').value;
    const status = document.getElementById('status');
    const downloadOptions = document.getElementById('download-options');

    if (!url) {
        status.textContent = '⚠️ الرجاء إدخال رابط صحيح';
        return;
    }

    status.textContent = '⏳ جاري تحليل الرابط...';
    downloadOptions.innerHTML = '';

    try {
‎        // استخدام CORS Proxy للتحايل على قيود CORS
        const proxyUrl = 'https://cors-anywhere.herokuapp.com/';
        const response = await fetch(proxyUrl + 'https://api.downloadmedia.net/api/convert', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ url: url })
        });

        const data = await response.json();

        if (data.formats && data.formats.length > 0) {
            status.textContent = '✅ اختر جودة التحميل:';
            
‎            // عرض خيارات التحميل
            data.formats.forEach(format => {
                const downloadButton = document.createElement('button');
                downloadButton.className = 'download-option';
                downloadButton.textContent = `تحميل ${format.quality}`;
                downloadButton.onclick = () => {
‎                    // تحميل مباشر
                    const a = document.createElement('a');

                    a.href = format.url;
                    a.download = `video_${Date.now()}.mp4`;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                };
                downloadOptions.appendChild(downloadButton);
            });
        } else {
            throw new Error('لم يتم العثور على روابط تحميل');
        }
    } catch (error) {
        status.textContent = '❌ حدث خطأ في التحميل';
        console.error(error);
    }
}

// تفعيل زر Enter
document.getElementById('url').addEventListener('keypress', e => {
    if (e.key === 'Enter') download();
});
</script>

<style>
/* الستايل السابق */

.download-options {
    margin-top: 20px;
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.download-option {
    padding: 10px;
    background: rgba(255, 255, 255, 0.1);
    border: none;
    border-radius: 8px;
    color: white;
    cursor: pointer;
    transition: 0.3s;
}

.download-option:hover {
    background: rgba(255, 255, 255, 0.2);
}
</style>
</body>
</html>
