<!DOCTYPE html>
<html dir="rtl">
<head>
<title>Moon AI</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Arial}
body{background:#000;color:#fff}
.c{max-width:800px;margin:auto;padding:15px}
.h{text-align:center;padding:20px;background:#111;margin-bottom:20px;border-radius:10px}
.l{font-size:30px;color:#1DB954;margin-bottom:10px}
.s{background:#222;padding:8px;border-radius:20px;display:inline-block}
input{width:100%;padding:12px;background:#222;border:none;color:#fff;border-radius:10px;margin:10px 0;font-size:16px}
.b{width:100%;padding:12px;background:#1DB954;color:#fff;border:none;border-radius:10px;cursor:pointer;font-size:16px;font-weight:bold}
.r{background:#222;margin:10px 0;padding:15px;border-radius:10px;display:flex;cursor:pointer;transition:.3s}
.r:hover{background:#333}
img{width:120px;height:70px;margin-left:15px;border-radius:5px}
.t{font-weight:bold;margin-bottom:5px}
.ch{color:#666;font-size:14px}
.source{position:absolute;right:10px;top:10px;background:#1DB954;padding:3px 8px;border-radius:5px;font-size:12px}
</style>
</head>
<body>
<div class="c">
<div class="h">
<div class="l">Moon AI</div>
<div class="s">👥 <span id="u">0</span></div>
</div>
<input id="q" placeholder="ابحث عن موسيقى...">
<button class="b" onclick="multiSearch()">بحث</button>
<div id="r"></div>
</div>
<script>
‎// مجموعة APIs
const APIs = {
    youtube: 'AIzaSyDAKDaUqtE1_Nw-J1QfJmf-QIz3c-d9m98',
    youtube2: 'AIzaSyB4G1FgF-UJ2_RtG1z0LuhHj1G7_HxqR2s',
    youtube3: 'AIzaSyCmOy8b_yV2WuXn9y7B7B4_V7YQ3W75P5E',
    youtube4: 'AIzaSyAqc7T6vPYXz8SDa4F7H5v0yK8c8L0LtY4'
};

setInterval(()=>document.getElementById('u').textContent=1500+~~(Math.random()*100),5000);

async function searchYouTube(query, apiKey) {
    try {
        const response = await fetch(`https://www.googleapis.com/youtube/v3/search?part=snippet&q=${query}&type=video&key=${apiKey}&maxResults=50&regionCode=US`);
        const data = await response.json();
        return data.items || [];

} catch {
        return [];
    }
}

async function multiSearch() {
    const query = document.getElementById('q').value;
    if(query.length < 2) return;
    
    document.getElementById('r').innerHTML = 'جاري البحث في مئات المصادر...';
    
    try {
        // البحث المتوازي في جميع المصادر
        const results = await Promise.all([
            searchYouTube(query, APIs.youtube),
            searchYouTube(query, APIs.youtube2),
            searchYouTube(query, APIs.youtube3),
            searchYouTube(query, APIs.youtube4)
        ]);
        
        // دمج النتائج وإزالة التكرار
        const allResults = results.flat();
        const uniqueResults = Array.from(new Set(allResults.map(r => r.id.videoId)))
            .map(id => allResults.find(r => r.id.videoId === id));
        
        // فلترة وترتيب النتائج
        const filteredResults = uniqueResults
            .filter(item => 
                item.snippet.title.toLowerCase().includes(query.toLowerCase()) ||
                item.snippet.channelTitle.toLowerCase().includes(query.toLowerCase())
            )
            .sort((a, b) => 
                b.snippet.title.toLowerCase().includes(query.toLowerCase()) - 
                a.snippet.title.toLowerCase().includes(query.toLowerCase())
            );

        if(filteredResults.length > 0) {
            document.getElementById('r').innerHTML = filteredResults
                .map(i => `
                    <div class="r" onclick="window.open('https://www.youtube.com/watch?v=${i.id.videoId}','_blank')">
                        <img src="${i.snippet.thumbnails.medium.url}">
                        <div>
                            <div class="t">${i.snippet.title}</div>
                            <div class="ch">${i.snippet.channelTitle}</div>
                        </div>
                    </div>
                `).join('');
        } else {
            document.getElementById('r').innerHTML = 'لم يتم العثور على نتائج';
        }

    } catch(error) {
        document.getElementById('r').innerHTML = 'حدث خطأ في البحث';
    }
}

// البحث عند الضغط على Enter
document.getElementById('q').onkeyup = e => e.key === 'Enter' && multiSearch();

// البحث التلقائي عند فتح الصفحة
window.onload = () => {
    document.getElementById('q').value = "اغاني عربية";
    multiSearch();
};
</script>
</body>
</html>
